#   Linux 常用命令

---

[TOC]

---

##	教学目标

*	文件命名规则
*	文件处理命令：权限，i节点，软硬链接的区别及特点，文件的创建，删除，拷贝，剪切，查看
*	权限管理命令：文件目录的 rwx 含义，修改权限，属主，属组，默认权限查看及设置
*	文件搜索命令：命令路径，find，快速查找locate，grep
*	帮助命令：	man，help，info
*	压缩解压缩命令：.gz,.tar.gz,.zip,.bz2, 压缩命令的特点
*	网络通信命令：ping，ifconfig，wall，write
*	shell应用技巧：命令补齐，历史记录，快捷键，别名，输入输出重定向，管道，命令替换符，命令链接符

##	练习内容

*	权限练习
*	软硬链接文件练习
*	find 查找练习
*	命令技巧练习

##   预备知识

---

###  文件命名规则

1.  文件名字符长度任意 （最大不逾255），所有字符平权合法（除了 /）
>   *注：win 系统文件名是 8.3 规则*
2.  尽量避免使用如下特殊符号
    + 空格符[SPACE]，制表符[TAB] : 命令，选项，参数以空格区分，若以空格符等作名会造成混淆。比如文件名 a b 代表一个文件，或是两个文件
    + 退格键[Backspace]
    + @,#,$,&,(,)，- ： 同理，在 linux 中会有这些字符参与的命令，选项与参数，为避免混淆最好不用

3.  避免使用 . 开头的普通文件名 ： 因为 . 开头的文件名代表隐藏文件
4.  大小写敏感，因为继承于C的特性，而 win 系统是不敏感的 
  
### 命令格式

命令格式 ：  
:   ***COMMAND [-OPTION]...[PARAMETER]...***

说明： 

1.  选项[OPTION]是操作的方式，参数[PARAMETER]是操作的对象
2.  短选项可以合并在一起使用
3.  普通用户 /bin , /usr/bin  
    超级用户 /sbin , /usr/sbin  
    应用程序 PATH/bin , PATH/sbin
    

### 命令类型

+   文件处理命令
+   权限管理命令
+   文件搜索命令
+   压缩解压命令
+   网络通信命令
+   系统关机命令
+   SHELL应用技巧
+   帮助命令

---

##  文件处理命令

---
### 文件查看与浏览
### 软链接与硬链接
        
    ln -s [SRC] [DES]   软链接 
    ln [SRC] [DES]  硬链接
    
说明：
      
*   软链接是一个符号链接，相当与一个快捷方式
*   软链接文件的大小是其名字的字符数，时间值是创建时间
*   软链接的权限 rwxrwxrwx，取决于实际链接的文件权限
*   硬链接相当于 cp -p加上同步更新的作用，可用于备份，硬链接的文件属性与源文件同
*   如果源文件被删除，软连接即失效，但是硬链接会继续存在，并且与源文件一致
*   软链接可以跨文件系统，而硬链接是不允许的
*   ***对软链接的权限修改，会导致源文件的权限修改，软链接自身权限不会改变***
*	不能对目录创建硬链接
*	创建硬链接会增加inode引用计数,对文件创建符号链接不会.

---

##  权限管理命令

---

### 改变文件的权限属性

    chmod [{ugo}{+-=}{rwx}] FILE|DIR
    chmod [421] FILE|DIR
        
### 文件与目录的权限

代表字母|r|w|x
---|---|---|---
权限|可读|可写|可执行
文件|查看文件的内容|修改文件的内容|执行文件
文件权限命令|cat,more,less|echo,vi|
目录|列出该目录中文件的列表可以创建|删除目录中的文件|切换进入目录
目录权限命令|ls|touch,mkdir,rm|cd
    
>  *注： 对于目录来说, r,x 通常是同时出现的。可以ls但不能进入目录，或者可以进入目录，却不能ls都是非常不可以思议的！*
    
### 改变文件或目录的属主

    chown USER FILE|DIR
        
### 改变文件或目录的属组

    chgrp GRP FILE|DIR
        
### 默认权限查询更改

    umask   查询默认权限,以用户权限掩码表示
    umask -S    查询默认权限，直观表达
    umask 027   修改默认权限
        
    
默认权限|目录|文件
--|--|--
普通用户|775|664
root用户|755|644
 
---

##  文件搜索命令

---

### 查看命令路径

    which COMMAND
    whereis COMMAND
        
说明：
    
*   which 不仅能找到命令绝对路径本身，还有对应命令别名记录
*   whereis 除显示命令绝对路径本身，还会显示命令相应的帮助文档

### 文件搜索命令

    find PATH [EXPRESSION]
    
    OPTION：
    -type [f|l|d]
    -name NAME  NAME是绝对匹配搜索的，win系统下会搜索所有包括名字中包含init的文件
    -inum INODE 查找i节点
    -size {+|-}SIZE  大小512Byte/Block
    -user USER  查找属主USER的文件
	-perm [4755]	查找权限位4755的文件	
    
    -ctime  -cmin {+|-}TIME   文件的属性/元文件被修改过的时间
    -atime  -amin {+|-}TIME   文件被浏览访问的时间
    -mtime  -mmin {+|-}TIME   文件内容被修改过的时间
    
    OPERATER:
    -a  逻辑与   -o  逻辑或
    -exec COMMAND {} \; 执行链接符
    -ok COMMAND {} \;   同上，但确认
	
>	*注:*
>	*{}	表 find 查询的结果*
>	*\\	转义符，符号命令使用本身的含义*
>	*；	结果*

例：如何删除/etc下有奇奇怪怪名字的文件

    ls -li
    find /etc -inum 234 -exec rm {} \;
    
### 按指定关键词搜索系统目录文件数据库

	locate [OPTION]...[PATTERN]

说明：

*	locate 是从系统目录文件数据库中搜索指定关键词的文件或目录
*	find 是在指定目录下实实在在地查找文件或目录
*	find 中可以查到的文件，可能在 locate 中无法搜索到，盖因系统的数据库暂未自动更新所故

###	更新目录文件数据库

	updatedb

说明：

*	执行权限 root
*	所在路径 /usr/bin/updatedb

###	按指定关键字符串搜索并输出文件中的相应行

	grep [OPTION]...[PATTERN] [FILE]...

说明：

---

##	帮助命令

---

###	查看命令或配置文件帮助，用户手册

	man [] [COMMAND|CONFIG]

说明：

*	man 不仅可以查询命令帮助，还可以查找配置文件帮助
*	man 优先查看命令帮助，自1->9逐一寻找，止于找到的第一个相应帮助内容

###	获得在线帮助指令

	info COMMAND

###	获得帮助索引的简短说明信息

	whatis 
	apropos [FILE]	相当于 man -k，查看manual page中与关键词匹配的所有文件相关信息，不是绝对匹配

说明：

*	均需建立相关帮助的索引数据库，故也是需要及时更新
*	若命令发生错误，便是 whatis database 未有建立
*	用 `makewhatis` 更新 whatisdb

###	查看 shell 内置命令的帮助

	help
	help SHELL_BUILDIN

说明：

*	如果 man  shell 的内置命令，有时会出现一大堆的命令列表，而非内置命令的帮助信息，这时可以判断为shell——buildin

---

##	压缩解压缩命令

---

###	GNU zip

	gzip FILE ---> File.gz

	gunzip FILE.gz
	gzip -d FILE.gz

说明：
*	只能压缩文件，不能压缩目录
*	不保留源文件

###	目录打包成文件命令

	tar [OPTION] DIR|FILE ... --> .tar|.tar.gz

	-c	产生 .tar 打包文件
	-r	追加内容到包 eg: tar -rf DIR.tar DIR
	-u	更新内容到包 eg: tar -uf DIR.tar FILES
	-v	显示详细信息
	-f	指定压缩后的文件名 eg: tar -f DIR.tar DIR
	-z	打包同时压缩 --> .tar.gz
	--exclude	排除不要打包的目录

*注：DIR.tar 是一个打包文件，不是目录*

***tar 打包的特性:默认保持文件属性***

例：将目录 testdir 打包成 newdir.tar.gz

	Solution1.	tar -cvfz newdir.tar.gz testdir
	Solution2.	tar -cvf newdir.tar testdir; gzip newdir.tar

###	解包命令

	tar [OPTION] FILE.tar|FILE.tar.gz

	-x	解包 .tar 文件
	-v	
	-f  指定解压的文件 eg: -f FILE.tar|FILE.tar.gz	
	-C	指定解压路径	*默认还原到打包的源目录*
	-t	查看打包文件
	-z	解压缩

例：将压缩打包文件 DIR.tar.gz 解包成 DIR

	Solution1.	tar -zxvf DIR.tar.gz 
	Solution2.	gunzip DIR.tar.gz; tar -xvf DIR.tar

例: 从指定压缩目录中取出特点文件

	tar -zxvf DIR.tar.gz FILE_NAME

***注: 	FILE_NAME 前面不能带`/`

### zip

	zip FILE.zip FILE
	zip -r DIR.zip DIR

	unzip FILE.zip|DIR.zip

说明：

*	.zip 默认 win 和 linux 通用格式
*	zip 不仅压缩文件，也压缩目录	
*	压缩信息中会提示压缩比
*	压缩后会保留源文件

###	bzip2

	bzip2 [OPTION] DIR
	-k	保留压缩前的源文件/目录

	bunzip2 DIR.bz2
	-k	保留解压缩前的原压缩文件

说明：

*	gzip 的升级版
*	压缩比惊人
*	除了 -k，特性与用法同 gzip

---

##	网络通信命令

---

###	网络消息命令

	wall [MESSAGE]	向所有用户广播
	write USER 	向某用户发送消息

说明：

*	均为实时在线消息

###	测试网络连通

	ping [OPTION] IP

	-c	ping 的次数
	-s  ICMP包调节大小，最大不超过65507

说明：

*	ping 成功，不代表网络没有问题， 还需要关注 time 和 packet loss
*	ping 不通对方 IP，ping 自己的 IP 能通，不是本机 IP 设置问题，可能是网络连接，对方连接，网络设置等问题
*	以上都 ping 不通，ping 回环地址127.0.0.1，证明本机TCP/IP 安装没有问题
*	ping 不通，不代表网络不通，尤其注意！

###	查询或更改网路设置信息

	ifconfig 网卡名 IP

	ifconfig
	-a	查询所有网卡信息

---

##	系统关机命令

---

###	关机命令

	shutdown 

	-h now	立即关机

###	重启命令

	reboot

---

##	Shell 应用技巧

---

###	命令/文件名补全

`TAB`	补全命令或文件名
`TAB` `TAB`	打印全部相关命令或文件名

> *注：若是 centos 直接在命令提示符后键入`TAB` `TAB`，那么会显示已经安装的所有命令

###	命令历史

	history

### Shell 快捷键

`Ctrl` + `l`	清屏键，相当于clear
`Ctrl` + `u`	清除光标前所有字符

###	命令别名

	alias NAME="COMMAND"
	alias	查询别名
	unalias	取消别名设置

###	输入输出重定向

	COMMAND > COVER_FILE
	COMMAND >> APPEND_FILE	重定向追加
	COMMAND 2> ERRFILE

	COMMAND < EXIST_FILE

文件描述符
：	

shell 对每个进程预先设定0，1，2，分别对应STDIN，STDOUT,STDERR

###	管道

管道：
:	将一个命令的输出传送给另一个命令，作为另一个命令的输入

	COMMAND1|COMMAND2|COMMAND3|...|COMMANDn

###	命令替换符

命令替换：
:	将一个命令的输出作为另一个命令的参数

	COMMAND1 `COMMAND2`

###	命令连接符

	COMMAND1；COMMAND2	间隔各命令，并按顺序依次执行
	COMMAND1 && COMMAND2	命令1执行成功，方执行命令2；命令1失败，不执行命令2
	COMMAND1 || COMMAND2	命令1执行成功，不执行命令2；命令1失败，方执行命令2
	

